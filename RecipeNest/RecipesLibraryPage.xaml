<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="RecipeNest.RecipesLibraryPage"
             Title="Recipes Library">

    <CollectionView ItemsSource="{Binding Recipes}"
                    SelectionMode="Single"
                    SelectionChanged="CollectionView_SelectionChanged">

        <CollectionView.Header>
            <VerticalStackLayout Padding="10" Spacing="20">

                <!-- Recipe of the Day -->
                <Border Padding="0">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="16" />
                    </Border.StrokeShape>
                    <Grid>
                        <Image Source="{Binding RecipeOfTheDay.ImageUrl}" 
                               Aspect="AspectFill" HeightRequest="200"/>
                        <BoxView BackgroundColor="Black" Opacity="0.3"/>
                        <Label Text="{Binding RecipeOfTheDay.Name}" 
                               TextColor="White" 
                               FontSize="Large" 
                               VerticalOptions="Center" 
                               HorizontalOptions="Center"/>
                    </Grid>
                </Border>

                <!-- Search Controls -->
                <StackLayout Orientation="Horizontal" Spacing="10">
                    <Picker Title="Search by"
                            WidthRequest="150"
                            SelectedItem="{Binding SelectedSearchMode}"
                            ItemsSource="{Binding SearchModes}"/>
                    <SearchBar Placeholder="Type your search..."
                               Text="{Binding SearchQuery}"
                               SearchCommand="{Binding SearchCommand}"/>
                </StackLayout>

            </VerticalStackLayout>
        </CollectionView.Header>


        <CollectionView.ItemsLayout>
            <GridItemsLayout Orientation="Vertical" Span="2"/>
        </CollectionView.ItemsLayout>


        <CollectionView.ItemTemplate>
            <DataTemplate>
                <Border Margin="5" Padding="5">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="12" />
                    </Border.StrokeShape>
                    <VerticalStackLayout>
                        <Image Source="{Binding ImageUrl}" 
                               HeightRequest="120" 
                               Aspect="AspectFill"/>
                        <Label Text="{Binding Name}" 
                               FontSize="Small" 
                               FontAttributes="Bold" 
                               LineBreakMode="TailTruncation"/>
                    </VerticalStackLayout>
                </Border>
            </DataTemplate>
        </CollectionView.ItemTemplate>

    </CollectionView>
</ContentPage>
